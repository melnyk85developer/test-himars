{"ast":null,"code":"import _regeneratorRuntime from\"/home/mr/www/melnyk85developer.github.io/test-himars/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/mr/www/melnyk85developer.github.io/test-himars/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/home/mr/www/melnyk85developer.github.io/test-himars/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/home/mr/www/melnyk85developer.github.io/test-himars/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{usersAPI}from\"../services/getUsers\";import{updateObjectInArray}from\"../utils/objectHelpers\";var FOLLOW='users/FOLLOW';var UNFOLLOW='users/UNFOLLOW';var SET_USERS='users/SET_USERS';var SET_CURRENT_PAGE='users/SET_CURRENT_PAGE';var SET_TOTAL_USERS_COUNT='users/SET_TOTAL_USERS_COUNT';var TOGGLE_IS_FETCHING='users/TOGGLE_IS_FETCHING';var TOGGLE_IS_FETCHING_PROGRESS='users/TOGGLE_IS_FETCHING_PROGRESS';var initialState={users:[],pageSize:100,totalUsersCount:0,currentPage:1,isFetching:true,followingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread(_objectSpread({},state),{},{users:updateObjectInArray(state.users,action.userId,\"id\",{followed:true})});case UNFOLLOW:return _objectSpread(_objectSpread({},state),{},{users:updateObjectInArray(state.users,action.userId,\"id\",{followed:false})});case SET_USERS:return _objectSpread(_objectSpread({},state),{},{users:action.users});case SET_CURRENT_PAGE:return _objectSpread(_objectSpread({},state),{},{currentPage:action.currentPage});case SET_TOTAL_USERS_COUNT:return _objectSpread(_objectSpread({},state),{},{totalUsersCount:action.count});case TOGGLE_IS_FETCHING:return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});case TOGGLE_IS_FETCHING_PROGRESS:return _objectSpread(_objectSpread({},state),{},{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.userId]):state.followingInProgress.filter(function(id){return id!==action.userId;})});default:return state;}};export var followSuccess=function followSuccess(userId){return{type:FOLLOW,userId:userId};};export var unfollowSuccess=function unfollowSuccess(userId){return{type:UNFOLLOW,userId:userId};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var setCurrentPage=function setCurrentPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var setUsersTotalCount=function setUsersTotalCount(totalUsersCount){return{type:SET_TOTAL_USERS_COUNT,count:totalUsersCount};};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var toggleFollowingProgress=function toggleFollowingProgress(isFetching,userId){return{type:TOGGLE_IS_FETCHING_PROGRESS,isFetching:isFetching,userId:userId};};export var requestUsers=function requestUsers(page,pageSize){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:dispatch(toggleIsFetching(true));dispatch(setCurrentPage(page));_context.next=4;return usersAPI.getUsers(page,pageSize);case 4:data=_context.sent;dispatch(toggleIsFetching(false));dispatch(setUsers(data.items));dispatch(setUsersTotalCount(data.totalCount));case 8:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};var followUnfollowFlow=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch,userId,apiMethod,actionCreator){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:dispatch(toggleFollowingProgress(true,userId));_context2.next=3;return apiMethod(userId);case 3:response=_context2.sent;if(response.data.resultCode===0){dispatch(actionCreator(userId));}dispatch(toggleFollowingProgress(false,userId));case 6:case\"end\":return _context2.stop();}},_callee2);}));return function followUnfollowFlow(_x2,_x3,_x4,_x5){return _ref2.apply(this,arguments);};}();export var follow=function follow(userId){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:followUnfollowFlow(dispatch,userId,usersAPI.follow.bind(usersAPI),followSuccess);case 1:case\"end\":return _context3.stop();}},_callee3);}));return function(_x6){return _ref3.apply(this,arguments);};}();};export var unfollow=function unfollow(userId){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:followUnfollowFlow(dispatch,userId,usersAPI.unfollow.bind(usersAPI),unfollowSuccess);case 1:case\"end\":return _context4.stop();}},_callee4);}));return function(_x7){return _ref4.apply(this,arguments);};}();};export default usersReducer;","map":{"version":3,"names":["usersAPI","updateObjectInArray","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USERS_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FETCHING_PROGRESS","initialState","users","pageSize","totalUsersCount","currentPage","isFetching","followingInProgress","usersReducer","state","arguments","length","undefined","action","type","_objectSpread","userId","followed","count","concat","_toConsumableArray","filter","id","followSuccess","unfollowSuccess","setUsers","setCurrentPage","setUsersTotalCount","toggleIsFetching","toggleFollowingProgress","requestUsers","page","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","data","wrap","_callee$","_context","prev","next","getUsers","sent","items","totalCount","stop","_x","apply","followUnfollowFlow","_ref2","_callee2","apiMethod","actionCreator","response","_callee2$","_context2","resultCode","_x2","_x3","_x4","_x5","follow","_ref3","_callee3","_callee3$","_context3","bind","_x6","unfollow","_ref4","_callee4","_callee4$","_context4","_x7"],"sources":["/home/mr/www/melnyk85developer.github.io/test-himars/src/store/usersReducer.js"],"sourcesContent":["import { usersAPI } from \"../services/getUsers\";\nimport { updateObjectInArray } from \"../utils/objectHelpers\";\n\nconst FOLLOW = 'users/FOLLOW';\nconst UNFOLLOW = 'users/UNFOLLOW';\nconst SET_USERS = 'users/SET_USERS';\nconst SET_CURRENT_PAGE = 'users/SET_CURRENT_PAGE';\nconst SET_TOTAL_USERS_COUNT = 'users/SET_TOTAL_USERS_COUNT';\nconst TOGGLE_IS_FETCHING = 'users/TOGGLE_IS_FETCHING';\nconst TOGGLE_IS_FETCHING_PROGRESS = 'users/TOGGLE_IS_FETCHING_PROGRESS';\n\nlet initialState = {\n    users: [],\n    pageSize: 100,\n    totalUsersCount: 0,\n    currentPage: 1,\n    isFetching: true,\n    followingInProgress: []\n}\nconst usersReducer = (state = initialState, action) => {\n    switch(action.type){\n        case FOLLOW:\n            return { \n                ...state, \n                users: updateObjectInArray(state.users, action.userId, \"id\",  {followed: true} )\n            }\n        case UNFOLLOW:\n            return { \n                ...state,\n                users: updateObjectInArray(state.users, action.userId, \"id\",  {followed: false} )\n            }\n        case SET_USERS: \n            return { ...state, users: action.users }\n        case SET_CURRENT_PAGE: \n            return { ...state, currentPage: action.currentPage }\n        case SET_TOTAL_USERS_COUNT: \n            return { ...state, totalUsersCount: action.count }\n        case TOGGLE_IS_FETCHING: \n            return { ...state, isFetching: action.isFetching }\n        case TOGGLE_IS_FETCHING_PROGRESS: \n            return { ...state, \n                followingInProgress: action.isFetching \n                ? [...state.followingInProgress, action.userId]\n                : state.followingInProgress.filter(id => id !== action.userId)\n            }\n        default:\n            return state;\n    }\n}\nexport const followSuccess = (userId) => ({ type: FOLLOW, userId })\nexport const unfollowSuccess = (userId) => ({ type: UNFOLLOW, userId })\nexport const setUsers = (users) => ({ type: SET_USERS, users })\nexport const setCurrentPage = (currentPage) => ({ type: SET_CURRENT_PAGE, currentPage })\nexport const setUsersTotalCount = (totalUsersCount) => ({ type: SET_TOTAL_USERS_COUNT, count: totalUsersCount })\nexport const toggleIsFetching = (isFetching) => ({ type: TOGGLE_IS_FETCHING, isFetching })\nexport const toggleFollowingProgress = (isFetching, userId) => ({ type: TOGGLE_IS_FETCHING_PROGRESS, isFetching, userId })\nexport const requestUsers = (page, pageSize) => {\n    return async (dispatch) => {\n        dispatch(toggleIsFetching(true));\n        dispatch(setCurrentPage(page));\n        const data = await usersAPI.getUsers(page, pageSize);\n        dispatch(toggleIsFetching(false));\n        dispatch(setUsers(data.items));\n        dispatch(setUsersTotalCount(data.totalCount));\n    }\n}\nconst followUnfollowFlow = async (dispatch, userId, apiMethod, actionCreator) => {\n    dispatch(toggleFollowingProgress(true, userId));\n    const response = await apiMethod(userId);\n    if(response.data.resultCode === 0){\n        dispatch(actionCreator(userId));\n    }\n    dispatch(toggleFollowingProgress(false, userId));\n}\nexport const follow = (userId) => {\n    return async (dispatch) => {\n        followUnfollowFlow(dispatch, userId, usersAPI.follow.bind(usersAPI), followSuccess);\n    }\n}\nexport const unfollow = (userId) => {\n    return async (dispatch) => {\n        followUnfollowFlow(dispatch, userId, usersAPI.unfollow.bind(usersAPI), unfollowSuccess);\n    }\n}\nexport default usersReducer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}